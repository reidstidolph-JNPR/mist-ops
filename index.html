<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg viewBox='0 0 190 189.6' version='1.1' id='svg2' sodipodi:docname='mist.svg' inkscape:version='1.3 (0e150ed, 2023-07-21)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg'%3E%3Cdefs id='defs2'%3E%3Cfilter style='color-interpolation-filters:sRGB;' inkscape:label='Greyscale' id='filter2' x='0' y='0' width='1' height='1'%3E%3CfeColorMatrix values='0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0 0 0 1 0 ' id='feColorMatrix2' /%3E%3C/filter%3E%3C/defs%3E%3Csodipodi:namedview id='namedview2' pagecolor='%23ffffff' bordercolor='%23000000' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' inkscape:zoom='1.2447257' inkscape:cx='95.201698' inkscape:cy='94.800003' inkscape:window-width='1312' inkscape:window-height='449' inkscape:window-x='185' inkscape:window-y='271' inkscape:window-maximized='0' inkscape:current-layer='svg2' /%3E%3Cg id='g2' style='filter:url(%23filter2)'%3E%3Cpolygon style='fill:%23E87200' points='190,0 102.2,0 102.2,40.9 149.1,40.9 149.1,87.8 190,87.8' id='polygon1' /%3E%3Cpolygon style='fill:%2384B135' points='50.9,51.4 50.9,91.5 98.5,91.5 98.5,139.2 138.7,139.2 138.7,51.4' id='polygon2' /%3E%3Crect style='fill:%230095A9' y='102' width='87.6' height='87.6' id='rect2' /%3E%3C/g%3E%3C/svg%3E%0A">
    <title>Ops Access</title>
    <link
      href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/vuetify@3.3.23/dist/vuetify.min.css"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@3.3.23/dist/vuetify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script>
  </head>

  <body>
    <div id="app"></div>
  </body>

  <!--
    Template
  -->
  <script type="text/x-template" id="app-template">
    <v-app>
      <v-container>
        <v-row class="d-flex mt-3 mb-3">
          <v-card
            width="100%"
          >
            <template v-slot:prepend>
                <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 190 189.6"> 
                  <g>
                      <polygon style="fill:#E87200" points="190,0 102.2,0 102.2,40.9 149.1,40.9 149.1,87.8 190,87.8"></polygon> 		
                      <polygon style="fill:#84B135" points="50.9,51.4 50.9,91.5 98.5,91.5 98.5,139.2 138.7,139.2 138.7,51.4"></polygon>
                      <rect style="fill:#0095A9" y="102" width="87.6" height="87.6"></rect>
                  </g>
               </svg>
            </template>

            <template v-slot:title>
              Ops Access
            </template>
            <v-card-text>

              <v-text-field
                v-model="org"
                label="Org ID"
              ></v-text-field>

              <v-select
                label="Environment"
                :items=environments
                v-model="selectedEnvironment"
              ></v-select>

              <v-slider
                v-model="days"
                class="align-center"
                :max="daysMax"
                :min="daysMin"
                :step="1"
                label="Days"
                hide-details
              >
                <template v-slot:append>
                  <v-text-field
                    v-model="days"
                    hide-details
                    single-line
                    density="compact"
                    type="number"
                    style="width: 70px"
                  ></v-text-field>
                  </template>
                </v-slider>


            </v-card-text>
          </v-card>
        </v-row>

        <v-row class="d-flex mt-3 mb-3">
          <v-card
            width="100%"
          >
            <v-card-text>
              <v-card color="black">
                <v-card-text>
                  <code>
                    <span id="slackText">request_ops_access org={{org}} duration={{days}} env={{mistEnvironments[selectedEnvironment].shortName}}</span>
                  </code>
                </v-card-text>
              </v-card>
              
            </v-card-text>
            <v-card-text>

              <v-timeline
                side="end"
                density="compact"
              >
                <v-timeline-item
                  fill-dot
                  class="mb-12"
                  dot-color="#E87200"
                  size="large"
                >
                <template v-slot:icon>
                  <span>1</span>
                </template>

                  <v-container>
                    <v-row>
                      <v-col>
                        <v-btn 
                          variant="tonal"
                          prepend-icon="mdi-content-copy"
                          class="text-none clipboard"
                          data-clipboard-target="#slackText"
                        >
                          Copy Ops Request
                        </v-btn>
                      </v-col>
                    </v-row>
                  </v-container>
                </v-timeline-item>

                <v-timeline-item
                  fill-dot
                  class="mb-12"
                  dot-color="#84B135"
                  size="large"
                >
                  <template v-slot:icon>
                    <span>2</span>
                  </template>

                  <v-container>
                    <v-row>
                      <v-col>
                        <v-btn 
                          variant="tonal"
                          href="slack://channel?team=T02MS68PQ&id=C3V77L7JA"
                          prepend-icon="mdi-slack"
                          class="text-none"
                        >
                          Open Slack
                        </v-btn>
                      </v-col>
                    </v-row>
                  </v-container>
                </v-timeline-item>

                <v-timeline-item
                  fill-dot
                  class="mb-12"
                  dot-color="#0095A9"
                  size="large"
                >
                  <template v-slot:icon>
                    <span>3</span>
                  </template>
                  <v-container>
                    <v-row>
                      <v-col>
                        <v-btn 
                          variant="tonal"
                          :href="`https://${mistEnvironments[selectedEnvironment].url}/admin/?org_id=${org}`" 
                          target="_blank"
                          class="text-none"
                        >
                          <template v-slot:prepend>
                            <svg
                              width="16"
                              height="16"
                              viewBox="0 0 190 189.6"
                              version="1.1"
                              id="svg2"
                              sodipodi:docname="mist.svg"
                              inkscape:version="1.3 (0e150ed, 2023-07-21)"
                              xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                              xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                              xmlns="http://www.w3.org/2000/svg"
                              xmlns:svg="http://www.w3.org/2000/svg">
                              <defs
                                id="defs2">
                                <filter
                                  style="color-interpolation-filters:sRGB;"
                                  inkscape:label="Greyscale"
                                  id="filter2"
                                  x="0"
                                  y="0"
                                  width="1"
                                  height="1">
                                  <feColorMatrix
                                    values="0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0.21 0.72 0.072 0 0 0 0 0 1 0 "
                                    id="feColorMatrix2" />
                                </filter>
                              </defs>
                              <sodipodi:namedview
                                id="namedview2"
                                pagecolor="#ffffff"
                                bordercolor="#000000"
                                borderopacity="0.25"
                                inkscape:showpageshadow="2"
                                inkscape:pageopacity="0.0"
                                inkscape:pagecheckerboard="0"
                                inkscape:deskcolor="#d1d1d1"
                                inkscape:zoom="1.2447257"
                                inkscape:cx="95.201698"
                                inkscape:cy="94.800003"
                                inkscape:window-width="1312"
                                inkscape:window-height="449"
                                inkscape:window-x="185"
                                inkscape:window-y="271"
                                inkscape:window-maximized="0"
                                inkscape:current-layer="svg2" />
                              <g
                                id="g2"
                                style="filter:url(#filter2)">
                                <polygon
                                  style="fill:#E87200"
                                  points="190,0 102.2,0 102.2,40.9 149.1,40.9 149.1,87.8 190,87.8"
                                  id="polygon1" />
                                <polygon
                                  style="fill:#84B135"
                                  points="50.9,51.4 50.9,91.5 98.5,91.5 98.5,139.2 138.7,139.2 138.7,51.4"
                                  id="polygon2" />
                                <rect
                                  style="fill:#0095A9"
                                  y="102"
                                  width="87.6"
                                  height="87.6"
                                  id="rect2" />
                              </g>
                            </svg>

                          </template>
                          Open Org
                        </v-btn>
                      </v-col>

                      <v-col>
                        <v-btn 
                          variant="tonal"
                          :href="`https://${mistEnvironments[selectedEnvironment].api}/api/v1/super/orgs/${org}/admins`" 
                          target="_blank"
                          prepend-icon="mdi-account"
                          class="text-none"
                        >
                          Get Admins
                        </v-btn>
                      </v-col>
                    </v-row>
                  </v-container>
                </v-timeline-item>

              </v-timeline>

            </v-card-text>

          </v-card>
        </v-row>

        <v-snackbar location="bottom center" v-model="copied" color="green">
          <span>Copied! <v-icon>mdi-check-circle</v-icon></span>
        </v-snackbar>

      </v-container>
    </v-app>
  </script>

  <!--
    Main Vue script
  -->
  <script>
    // clipboard
    const clipboard = new ClipboardJS('.clipboard')

    const { createApp, ref } = Vue
    const { createVuetify } = Vuetify
    const vuetify = createVuetify()

    const mistEnvironments = {
      'Global01': {
        'shortName': 'production',
        'url': 'manage.mist.com',
        'api': 'api.mist.com'
      },
      'Global02': {
        'shortName': 'gc1',
        'url': 'manage.gc1.mist.com',
        'api': 'api.gc1.mist.com'
      },
      'Global03': {
        'shortName': 'ac2',
        'url': 'manage.ac2.mist.com',
        'api': 'api.ac2.mist.com'
      },
      'Global04': {
        'shortName': 'gc2',
        'url': 'manage.gc2.mist.com',
        'api': 'api.gc2.mist.com'
      },
      'Emea01': {
        'shortName': 'eu',
        'url': 'manage.eu.mist.com',
        'api': 'api.eu.mist.com'
      },
      'Emea02': {
        'shortName': 'gc3',
        'url': 'manage.gc3.mist.com',
        'api': 'api.gc3.mist.com'
      },
      'Emea03': {
        'shortName': 'ac6',
        'url': 'manage.ac6.mist.com',
        'api': 'api.ac6.mist.com'
      },
      'Apac01': {
        'shortName': 'ac5',
        'url': 'manage.ac5.mist.com',
        'api': 'api.ac5.mist.com'
      },
      'Global99': {
        'shortName': 'ac99',
        'url': 'manage.ac99.mist.com',
        'api': 'api.ac99.mist.com'
      },
    }
    
    const app = createApp({
      template: "#app-template",
      setup() {
        const environments = ref(['Global01', 'Global02', 'Global03', 'Global04', 'Emea01', 'Emea02', 'Emea03', 'Apac01', 'Global99'])
        const org = ref('')
        const selectedEnvironment=ref('Global01')
        const days = ref(1)
        const daysMax = ref(15)
        const daysMin = ref(1)
        var copied = ref(false)

        clipboard.on('success', function(e) {
          console.log('text copied!')
          copied.value = true
          setTimeout(()=>{copied.value = false},5000)
        })

        return {environments, mistEnvironments, selectedEnvironment, copied, org, days, daysMax, daysMin}
      }
    })
      .use(vuetify)
      .mount("#app")
  </script>

</html>